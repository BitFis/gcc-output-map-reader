(this["webpackJsonpgcc-output-map-viewer"]=this["webpackJsonpgcc-output-map-viewer"]||[]).push([[0],{105:function(e,t,n){},106:function(e,t,n){},113:function(e,t,n){},116:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(85),o=(n(105),n(7)),s=(n(106),n(163)),u=n(167),l=n(166),d=n(164),h=n(156),b=n(165),f=n(159),j=n(86),p=n(87),S=n(10),O=n(44),m=n(45),v=n(20),x=n(21),g=n(17);function y(){return A.apply(this,arguments)}function A(){return(A=Object(g.a)(Object(S.a)().mark((function e(){return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,0)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=function(){function e(t,n,a,r,c){Object(v.a)(this,e),this.Section=t,this.FullName=n,this.StartAddress=a,this.Size=r,this.FullFileName=c,this.Additonal=[],this.MangledList=[],this.AddressSpaceSize=-1,this.Name=void 0,this.Mangled="",this.FileName="",this.Module="";var i=/([^\(]+)\(([^\)]+)/g.exec(c);i?(this.FileName=i[1]||c,this.Module=i[2]||""):this.FileName=c;var o=/(\.[^\.]+)(.*)/g.exec(n);o?(this.Name=o[1]||"",this.Mangled=o[2]||""):this.Name=n}return Object(x.a)(e,[{key:"getNumRecords",value:function(){var e=0;return this.Size>0&&(e+=1,this.MangledList.length>0&&this.MangledList.sort((function(e,t){return e.AddressStart-t.AddressStart})).reduce((function(t,n){return t.AddressStart!=n.AddressStart&&e++,n}))),e}},{key:"parse",value:function(e){for(var t,n=/\n[^\.\n](\*[^\n]*| +)(0x[0-9a-fA-F]+|[^ ]+)? *([^\n]*)/gm,a=0,r=!1,c=0,i=0;null!=(t=n.exec(e));){var o=t[1];if(o)if(o.startsWith("*"))this.Additonal.push(o);else if(""===o.trim()){var s=t[2],u=t[3]?t[3]:"";if(!/^0x([0-9a-fA-F])+$/.test(s)){"[!provide]"!==s.trim()&&console.debug("Ignoring SubSection content '".concat(s,"' in ").concat(this.Section,":").concat(this.Name),e),r=!0;continue}if(s.length==R.ADDRESS_HEX_LENGTH){var l=parseInt(s,16),d=0;this.MangledList.length>0&&(d=l-c),this.MangledList.push({AddressStart:parseInt(s,16),MangledName:u,Size:d}),c=l,i+=d,r||(a+=1)}}else console.log("Potential SubSection parse issue in ".concat(this.Section,":").concat(this.Name," - strange start: '").concat(o,"' (expected * or ' ')"),e);else console.log("Potential SubSection parse issue in ".concat(this.Section,":").concat(this.Name),e)}return this.MangledList.length>0&&(this.Size-i<0?console.error("Issue while parsing, got negative number? ".concat(this.Size," - ").concat(i," = ").concat(this.Size-i),this):this.MangledList[0].Size=this.Size-i),a}}]),e}(),N=function(){function e(t,n,a){Object(v.a)(this,e),this.Name=t,this.StartAddress=n,this.Size=a,this.NumRecords=0,this.AddressSpaceSize=0,this.SubSectionsList=[]}return Object(x.a)(e,[{key:"parse",value:function(e,t){for(var n,a=/ (\.[^ \t\n]+|COMMON)\n? +(0x[0-9a-fA-F]+) +(0x[0-9a-fA-F]+) ?([^\n]+)?((\n [^\.*][^\n]*)*)/gm;null!=(n=a.exec(e));){var r=n[1],c=n[2]?parseInt(n[2]):0,i=n[3]?parseInt(n[3]):0,o=n[4],s=new w(this.Name,r.replace(/\.text.+/,""),c,i,o);n[5]&&s.parse(n[5]),this.SubSectionsList.push(s),t.SubSections.push(s),this.NumRecords+=s.getNumRecords(),"COMMON"===r&&(this.NumRecords-=1)}return this.SubSectionsList}},{key:"append",value:function(e){0==this.StartAddress?this.StartAddress=e.StartAddress:0!=e.StartAddress&&console.log("undefined behaviour, joining section ".concat(e.Name," - section exists twice with a address")),0==this.Size?this.Size=e.Size:0!=e.Size&&console.log("undefined behaviour, joining section ".concat(e.Name," - section exists twice with a size")),0==this.NumRecords?this.NumRecords=e.NumRecords:0!=e.NumRecords&&console.log("undefined behaviour, joining section ".concat(e.Name," - containing records twice"))}}]),e}(),E=Object(x.a)((function e(){Object(v.a)(this,e),this.Archives={},this.Sections={}})),R=function(e){Object(O.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(v.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).currentPos=0,e.SubSections=[],e}return Object(x.a)(n,[{key:"parseArchiveMatch",value:function(e,t){e.length<4&&console.log("Unexpected parsing at character ".concat(e.index," - ").concat(t.lastIndex),e[0]);var n="".concat(e[1]),a={CompilationUnit:e[3],FileLocation:e[1],Symbol:e[2],SymbolCall:e[4]};this.Archives[n]||(this.Archives[n]={Archives:[],File:a.FileLocation,NumRecords:0}),this.Archives[n].NumRecords++,this.Archives[n].Archives.push(a)}},{key:"parseSectionMatch",value:function(e,t){if(e.length<=4)console.log("parser error at: ".concat(e.index," ").concat(t.lastIndex));else if(e.length>=3){var n,a,r=e[1],c=null===(n=e[2])||void 0===n?void 0:n.slice(2),i=null===(a=e[3])||void 0===a?void 0:a.slice(2);if(!r||!c&&i||c&&!i)return void console.warn("possible parsing error at character ".concat(e.index," - ").concat(t.lastIndex));var o=new N(r,c?parseInt(c,16):0,i?parseInt(i,16):0);o.parse(e[4],this),this.Sections[r]?this.Sections[r].append(o):this.Sections[r]=o}else console.log("parser error at: ".concat(e.index," ").concat(t.lastIndex))}},{key:"getSegmentRegex",value:function(e){var t=n.SEGMENT_STARTS_LIST.slice(),a=void 0,r=void 0;return new RegExp(n.ARCHIVE_START,"g").test(e)?(r="ARCHIVE",t.push(n.ARCHIVE_REGEX),a=this.parseArchiveMatch.bind(this)):new RegExp(n.SECTION_START,"g").test(e)&&(r="SECTION",t.push(n.SECTION_REGEX),a=this.parseSectionMatch.bind(this)),{Regex:new RegExp("(".concat(t.join("|"),")"),"gm"),ParseFunction:a,activeSegment:r}}},{key:"parse",value:function(){var e=Object(g.a)(Object(S.a)().mark((function e(t){var a,r,c;return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={Regex:new RegExp("(".concat(n.SEGMENT_STARTS_LIST.join("|"),")"),"gm"),activeSegment:"START"};case 1:if(null===(r=a.Regex.exec(t))){e.next=8;break}return r[2]?(r.shift(),a.ParseFunction?a.ParseFunction(r,a.Regex,this):console.debug("unexpected match, no parsing function provided",r[0])):(c=a.Regex.lastIndex,(a=this.getSegmentRegex(r[1])).Regex.lastIndex=c),e.next=6,y();case 6:e.next=1;break;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(E);a=R,R.TurnOnAMPEquality=!1,R.ADDRESS_HEX_LENGTH=18,R.ADDRESS_MATCHER="(0x[0-9a-fA-F]{8,})",R.SECTION_SIZE_MATCHER="(0x[0-9a-fA-F]+)",R.SECTION_REGEX="\n(\\.[^ \n\\t]+)\n? *".concat(a.ADDRESS_MATCHER,"? *").concat(a.SECTION_SIZE_MATCHER,"?([^\n]*(\n [^\n]*)*)"),R.ARCHIVE_REGEX="\n([^\\(\n ]+)\\(([^\\)]+)\\)\n +([^\n ]+) +([^\n]+)",R.ARCHIVE_START="Archive member included to satisfy reference by file[^\n]*",R.SECTION_START="Linker script and memory map[^\n]*",R.SEGMENT_STARTS_LIST=[a.ARCHIVE_START,"Merging program properties[^\n]*","Discarded input sections[^\n]*","Memory Configuration[^\n]*",a.SECTION_START];var M=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();Object(v.a)(this,e),this.start=t}return Object(x.a)(e,[{key:"ElapsedMs",value:function(){return Date.now()-this.start}},{key:"Reset",value:function(){this.start=Date.now()}},{key:"Format",value:function(){return e.Format(this.ElapsedMs())}}],[{key:"SleepMs",value:function(){var e=Object(g.a)(Object(S.a)().mark((function e(t){return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"str",value:function(e,t){return e?"".concat(e).concat(t):""}},{key:"Format",value:function(t){var n=t%1e3;t-=n;var a=Math.floor(t/1e3%60);t-=1e3*a;var r=Math.floor(t/60/1e3%60);t-=60*r*1e3;var c=Math.floor(t/60/60/1e3);return t-=60*c*60*1e3,[e.str(c,"h"),e.str(r,"min"),e.str(a,"s"),e.str(n,"ms")].join(" ").trim()}}]),e}(),I=M,T=n(2),z=function(e){var t=e.OnLoaded,n=Object(p.useFilePicker)({multiple:!1,accept:[".map"]}),a=Object(o.a)(n,4),c=a[0],i=a[1],s=(a[2],a[3]),l=Object(r.useState)(!1),d=Object(o.a)(l,2),O=d[0],m=d[1],v=Object(r.useState)(!1),x=Object(o.a)(v,2),y=x[0],A=x[1],w=Object(r.useState)(!1),N=Object(o.a)(w,2),E=N[0],M=N[1],z=Object(r.useState)(!1),F=Object(o.a)(z,2),k=F[0],C=F[1];return c[0]&&console.log("loading through filesystem currently not supported!",JSON.stringify(c)),Object(T.jsxs)("div",{children:[i.length>0?Object(T.jsxs)(h.a,{onClose:function(){return i.length=0},severity:"error",children:[Object(T.jsx)(b.a,{children:"Error occured while opening file!"}),JSON.stringify(i)]}):"",E?Object(T.jsxs)(h.a,{onClose:function(){return M(!1)},severity:"warning",children:[Object(T.jsx)(b.a,{children:E}),"Drop the file onto the region."]}):"",y?Object(T.jsxs)(h.a,{onClose:function(){return A(!1)},severity:"error",children:[Object(T.jsx)(b.a,{children:"Loading Dropped file failed!"}),y]}):"",Object(T.jsx)(j.FileDrop,{onDrop:function(e){var n=new I;n.Reset(),console.debug("Start loading file"),m(!0),function(e){return 1===(null===e||void 0===e?void 0:e.length)?e.item(0).arrayBuffer().then(function(){var e=Object(g.a)(Object(S.a)().mark((function e(t){var n,a;return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="",new Uint8Array(t).forEach((function(e){n+=String.fromCharCode(e)})),a=new R,e.next=5,a.parse(n);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):new Promise((function(t,n){n("provide one file!"),console.error(e)}))}(e).then(t).catch((function(e){return A(e)})).finally((function(){m(!1),console.debug("Loading and parsing file done [".concat(n.Format(),"]"))}))},onDragOver:function(){k||C(!0)},onDragLeave:function(){k&&C(!1)},children:Object(T.jsx)(u.a,{sx:{p:0,border:"1px dashed grey",m:"auto"},justifyContent:"center",justifyItems:"center",children:Object(T.jsx)(f.a,{disabled:s||O,onClick:function(){M("openFileSelector currently not supported")},sx:{p:3,m:"auto"},fullWidth:!0,style:k?{backgroundColor:"rgba(63, 81, 181, 0.04)"}:{},children:s||O?"Loading ... (Will currently block any interaction)":"Drop output.map here"})})})]})},F=n(92),k=n.n(F),C=n(40),D=n(94),L=(n(113),function(e){var t=e.data,n=e.columns;return Object(T.jsx)("div",{children:Object(T.jsx)(D.a,{data:t,columns:n,search:!0,sort:!0,pagination:{enabled:!0,limit:200},className:{td:"dense-table-cell light-content",th:"dense-table-cell",footer:"dense-table-cell"}})})}),_=n(152),P=n(171),H=n(154),V=n(168),B=function(){function e(){Object(v.a)(this,e)}return Object(x.a)(e,null,[{key:"Size",value:function(e){var t=e;e-=e%1e3;var n=Math.floor(e/1e3%1e3);e-=n;var a=Math.floor(e/1e3/1e3);return a>0?"".concat(t," (+").concat(a,"M)"):n>0?"".concat(t," (+").concat(n,"K)"):"".concat(t)}},{key:"ToHex",value:function(e){return"0x"+"0000000000000000".concat(e.toString(16)).slice(-16)}}]),e}(),G=["Section","SubSection","AddressHex",{name:"Size",formatter:function(e){return B.Size(e)}},"Demangled Name","Moduled Name","File Name","Mandled Name"],W=function(e){var t=e.data;return Object(T.jsx)(L,{data:t,columns:G})},X=["Module","Size no .bss",{name:"Size",formatter:function(e){return B.Size(e)}},"Num of records"];function J(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var U=n(162),q=function(){return Object(T.jsxs)("div",{children:[Object(T.jsx)(U.a,{animation:!1,height:64}),Object(T.jsx)(U.a,{variant:"rectangular",animation:!1,height:500})]})},Z=function(){function e(t){Object(v.a)(this,e),this.ColumnsOrder=t,this.Items=[]}return Object(x.a)(e,[{key:"add",value:function(e){var t=[];this.ColumnsOrder.forEach((function(n){t.push(e[n])})),this.Items.push(t)}}]),e}(),$=function(e){var t=e.data,n=Object(r.useState)("all"),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)([]),l=Object(o.a)(s,2),d=l[0],h=l[1],b=Object(r.useState)([]),f=Object(o.a)(b,2),j=f[0],p=f[1];Object(r.useEffect)((function(){S(t)}),[t]);var S=function(e){var t=new I;console.debug("Start preparing database");var n=new Z(G.map((function(e){return e.name||e}))),a=new Z(X.map((function(e){return e.name||e}))),r={"Num of records":0,"Size no .bss":-1,Module:"",Size:0},c={};Object.keys(e.Archives).forEach((function(t){c[t]={"Num of records":0,"Size no .bss":-1,Module:t,Size:0,File:e.Archives[t].File}})),Object.keys(e.Sections).forEach((function(t){e.Sections[t].SubSectionsList.forEach((function(e){var t={"Demangled Name":"","File Name":e.FileName,"Mandled Name":e.Mangled.replace(/$\.(text|data)/g,""),Address:e.StartAddress,AddressHex:B.ToHex(e.StartAddress),Section:e.Section,SubSection:e.Name,Size:e.Size,"Moduled Name":""},a=c[e.FileName];a||(a=r),a.Size+=e.Size,e.MangledList.length>0?e.MangledList.forEach((function(e){t["Mandled Name"]=e.MangledName,t.Size=e.Size,t.Address=e.AddressStart,t.AddressHex=B.ToHex(e.AddressStart),n.add(t),e.Size>0&&a["Num of records"]++})):(e.Size>0&&a["Num of records"]++,n.add(t))}))})),a.add(r),Object.keys(c).forEach((function(e){a.add({"Num of records":c[e]["Num of records"],"Size no .bss":c[e]["Size no .bss"],Module:c[e].Module,Size:c[e].Size})})),h(n.Items),p(a.Items),console.debug("Database views prepared ".concat(t.Format()))};return Object(T.jsxs)(_.a,{value:c,children:[Object(T.jsx)(u.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(T.jsxs)(H.a,{value:c,onChange:function(e,t){i(t)},"aria-label":"Data analyze section",children:[Object(T.jsx)(V.a,Object(C.a)({label:"All",value:"all"},J(0))),Object(T.jsx)(V.a,Object(C.a)({label:"By Module",value:"by_module"},J(1))),Object(T.jsx)(V.a,Object(C.a)({label:"By File (WIP)",value:"by_file"},J(2))),Object(T.jsx)(V.a,Object(C.a)({label:"By Section (WIP)",value:"by_section"},J(3))),Object(T.jsx)(V.a,Object(C.a)({label:"By SubSection (WIP)",value:"by_subsection"},J(4)))]})}),Object(T.jsx)(P.a,{value:"all",children:Object(T.jsx)(W,{data:d})}),Object(T.jsx)(P.a,{value:"by_module",children:Object(T.jsx)(L,{data:j,columns:X})}),Object(T.jsx)(P.a,{value:"by_file",children:Object(T.jsx)(q,{})}),Object(T.jsx)(P.a,{value:"by_section",children:Object(T.jsx)(q,{})}),Object(T.jsx)(P.a,{value:"by_subsection",children:Object(T.jsx)(q,{})})]})},K=n(5),Q=n(158),Y=n(161),ee=n(155),te=n(170),ne=n(169),ae=n(91),re=n.n(ae),ce=n(52),ie=function(e){return e[e.Idle=0]="Idle",e[e.Start=1]="Start",e[e.Download=2]="Download",e[e.Prepare=3]="Prepare",e[e.Parse=4]="Parse",e[e.LoadView=5]="LoadView",e[e.Done=6]="Done",e[e.Failed=7]="Failed",e}(ie||{});function oe(e){return Object(T.jsxs)(u.a,{sx:{position:"relative",display:"inline-flex"},children:[Object(T.jsx)(ne.a,Object(C.a)({size:"6rem",variant:"determinate"},e)),Object(T.jsx)(u.a,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:Object(T.jsx)(l.a,{variant:"caption",component:"div",color:"text.secondary",children:e.label})})]})}var se="file",ue=function(e){var t=e.OnLoaded,n=Object(ce.b)(),a=Object(o.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)((function(){var e=c.get(se);return e||""})),u=Object(o.a)(s,2),l=u[0],f=u[1],j=Object(r.useState)(w(ie.Idle)),p=Object(o.a)(j,2),O=p[0],m=p[1],v=Object(r.useState)(null),x=Object(o.a)(v,2),y=x[0],A=x[1];function w(e){return{Progress:E(e),State:e}}function N(e){m(w(e))}function E(e){var t=0;switch(e){case ie.Idle:case ie.Failed:case ie.Start:t=0;break;case ie.Download:t=1;break;case ie.Prepare:t=2;break;case ie.Parse:t=3;break;case ie.LoadView:t=4;break;case ie.Done:t=5}return 20*t}function M(e){var n=new I;i(c),console.debug("Start Download: '".concat(e,"'")),m({State:ie.Start,Progress:0}),fetch(e).then((function(t){return new Promise((function(n,a){N(ie.Download),t.ok?(console.debug("Download success"),n(t.blob())):(console.error("Request '".concat(e,"' faield"),t),a(t))}))})).then(function(){var e=Object(g.a)(Object(S.a)().mark((function e(t){return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(ie.Prepare),console.debug("Start process ".concat(t.size," bytes (").concat(n.Format(),")")),e.abrupt("return",t.text());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(function(){var e=Object(g.a)(Object(S.a)().mark((function e(t){var a;return Object(S.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N(ie.Parse),a=new R,e.next=4,a.parse(t);case 4:return console.debug("Data processed (".concat(n.Format(),")")),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){N(ie.LoadView),t(e)})).then((function(){N(ie.Done)})).catch((function(e){console.error("Download failed ".concat(e)),A("")})).finally((function(){console.debug("Download of ".concat(e," done (").concat(n.Format(),")")),N(ie.Done)}))}return Object(r.useEffect)((function(){var e=c.get(se);e&&M(e)}),[c]),Object(T.jsxs)("div",{children:[Object(T.jsx)(Q.a,{sx:{color:"#fff",zIndex:function(e){return e.zIndex.drawer+1}},open:!(O.State==ie.Idle||O.State==ie.Done),children:Object(T.jsx)(oe,{value:O.Progress,label:ie[O.State]})}),null!=y?Object(T.jsxs)(h.a,{onClose:function(){return A(null)},severity:"error",children:[Object(T.jsx)(b.a,{children:"Download Failed!"}),y]}):"",Object(T.jsxs)(Y.a,{component:"form",sx:{p:"2px 4px",display:"flex",alignItems:"center"},onSubmit:function(e){e.preventDefault(),c.set(se,l),M(l)},children:[Object(T.jsx)(ee.a,{sx:{ml:1,flex:1},placeholder:"Download by url",inputProps:{"aria-label":"search google maps"},value:l,fullWidth:!0,onChange:function(e){return f(e.target.value)}}),Object(T.jsx)(te.a,{sx:{height:28,m:.5},orientation:"vertical"}),Object(T.jsx)(d.a,{onClick:function(){c.set(se,l),M(l)},color:"primary",sx:{p:"10px"},"aria-label":"directions",children:Object(T.jsx)(re.a,{})})]})]})};function le(){return Object(T.jsx)(s.a,{maxWidth:"lg",children:Object(T.jsxs)(u.a,{my:4,children:[Object(T.jsxs)(l.a,{variant:"h4",component:"h1",gutterBottom:!0,children:[Object(T.jsx)(d.a,{href:"./gcc-output-map-web-renderer.zip",size:"large",children:Object(T.jsx)(k.a,{color:"action"})}),"output.map viewer"]}),Object(T.jsx)(K.a,{})]})})}function de(){var e=Object(r.useState)(new E),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(T.jsxs)("div",{children:[Object(T.jsx)(z,{OnLoaded:a}),Object(T.jsx)(ue,{OnLoaded:a}),Object(T.jsx)($,{data:n})]})}var he=function(){return Object(T.jsx)(K.d,{children:Object(T.jsx)(K.b,{path:"/",element:Object(T.jsx)(le,{}),children:Object(T.jsx)(K.b,{path:"*?",index:!0,element:Object(T.jsx)(de,{})})})})},be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,172)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},fe=document.getElementById("root");if(!fe)throw Error("Root element not found");Object(i.createRoot)(fe).render(Object(T.jsx)(c.a.StrictMode,{children:Object(T.jsx)(ce.a,{children:Object(T.jsx)(he,{})})})),be()}},[[116,1,2]]]);
//# sourceMappingURL=main.8b646773.chunk.js.map